# File author is √çtalo Lima Marconato Matias
#
# Created on October 29 of 2019, at 19:46 BRT
# Last edited on December 25 of 2019, at 22:41 BRT

ARCH ?= x86
VERBOSE ?= false
DEBUG ?= false

SYSROOT_DIR ?=
LIB_DIR ?= System/Libraries
INC_DIR ?= Development/Headers
PROG_DIR ?= System/Programs
THEME_DIR ?= System/Themes
FONT_DIR ?= System/Fonts

ifeq ($(ARCH),x86)
	SUBARCH ?= 32

	ifeq ($(SUBARCH),32)
		TARGET ?= i686-chicago
	else ifeq ($(SUBARCH),64)
		TARGET ?= x86_64-chicago
	else
		UNSUPPORTED_ARCH := true
	endif
else
	UNSUPPORTED_ARCH := true
endif

ifneq ($(VERBOSE),true)
NOECHO := @
endif

all:
ifeq ($(UNSUPPORTED_ARCH),true)
	$(error Unsupported architecture $(ARCH), subarch $(SUBARCH))
endif
	$(NOECHO)ARCH=$(ARCH) SUBARCH=$(SUBARCH) TARGET=$(TARGET) VERBOSE=$(VERBOSE) DEBUG=$(DEBUG) SYSROOT_DIR=$(SYSROOT_DIR) LIB_DIR=$(LIB_DIR) INC_DIR=$(INC_DIR) make -C libchicago all install
	$(NOECHO)ARCH=$(ARCH) SUBARCH=$(SUBARCH) TARGET=$(TARGET) VERBOSE=$(VERBOSE) DEBUG=$(DEBUG) SYSROOT_DIR=$(SYSROOT_DIR) PROG_DIR=$(PROG_DIR) make -C osmngr all
	$(NOECHO)ARCH=$(ARCH) SUBARCH=$(SUBARCH) TARGET=$(TARGET) VERBOSE=$(VERBOSE) DEBUG=$(DEBUG) SYSROOT_DIR=$(SYSROOT_DIR) PROG_DIR=$(PROG_DIR) THEME_DIR=$(THEME_DIR) FONT_DIR=$(FONT_DIR) make -C guimngr all
	$(NOECHO)ARCH=$(ARCH) SUBARCH=$(SUBARCH) TARGET=$(TARGET) VERBOSE=$(VERBOSE) DEBUG=$(DEBUG) SYSROOT_DIR=$(SYSROOT_DIR) LIB_DIR=$(LIB_DIR) INC_DIR=$(INC_DIR) make -C libgui all install
	$(NOECHO)ARCH=$(ARCH) SUBARCH=$(SUBARCH) TARGET=$(TARGET) VERBOSE=$(VERBOSE) DEBUG=$(DEBUG) SYSROOT_DIR=$(SYSROOT_DIR) PROG_DIR=$(PROG_DIR) make -C guitest all

install:
ifeq ($(UNSUPPORTED_ARCH),true)
	$(error Unsupported architecture $(ARCH), subarch $(SUBARCH))
endif
	$(NOECHO)ARCH=$(ARCH) SUBARCH=$(SUBARCH) TARGET=$(TARGET) VERBOSE=$(VERBOSE) DEBUG=$(DEBUG) SYSROOT_DIR=$(SYSROOT_DIR) LIB_DIR=$(LIB_DIR) INC_DIR=$(INC_DIR) make -C libchicago install
	$(NOECHO)ARCH=$(ARCH) SUBARCH=$(SUBARCH) TARGET=$(TARGET) VERBOSE=$(VERBOSE) DEBUG=$(DEBUG) SYSROOT_DIR=$(SYSROOT_DIR) PROG_DIR=$(PROG_DIR) make -C osmngr install
	$(NOECHO)ARCH=$(ARCH) SUBARCH=$(SUBARCH) TARGET=$(TARGET) VERBOSE=$(VERBOSE) DEBUG=$(DEBUG) SYSROOT_DIR=$(SYSROOT_DIR) PROG_DIR=$(PROG_DIR) THEME_DIR=$(THEME_DIR) FONT_DIR=$(FONT_DIR) make -C guimngr install
	$(NOECHO)ARCH=$(ARCH) SUBARCH=$(SUBARCH) TARGET=$(TARGET) VERBOSE=$(VERBOSE) DEBUG=$(DEBUG) SYSROOT_DIR=$(SYSROOT_DIR) LIB_DIR=$(LIB_DIR) INC_DIR=$(INC_DIR) make -C libgui install
	$(NOECHO)ARCH=$(ARCH) SUBARCH=$(SUBARCH) TARGET=$(TARGET) VERBOSE=$(VERBOSE) DEBUG=$(DEBUG) SYSROOT_DIR=$(SYSROOT_DIR) PROG_DIR=$(PROG_DIR) make -C guitest install

clean:
ifeq ($(UNSUPPORTED_ARCH),true)
	$(error Unsupported architecture $(ARCH), subarch $(SUBARCH))
endif
	$(NOECHO)ARCH=$(ARCH) SUBARCH=$(SUBARCH) TARGET=$(TARGET) VERBOSE=$(VERBOSE) DEBUG=$(DEBUG) SYSROOT_DIR=$(SYSROOT_DIR) LIB_DIR=$(LIB_DIR) INC_DIR=$(INC_DIR) make -C libchicago clean
	$(NOECHO)ARCH=$(ARCH) SUBARCH=$(SUBARCH) TARGET=$(TARGET) VERBOSE=$(VERBOSE) DEBUG=$(DEBUG) SYSROOT_DIR=$(SYSROOT_DIR) PROG_DIR=$(PROG_DIR) make -C osmngr clean
	$(NOECHO)ARCH=$(ARCH) SUBARCH=$(SUBARCH) TARGET=$(TARGET) VERBOSE=$(VERBOSE) DEBUG=$(DEBUG) SYSROOT_DIR=$(SYSROOT_DIR) PROG_DIR=$(PROG_DIR) THEME_DIR=$(THEME_DIR) FONT_DIR=$(FONT_DIR) make -C guimngr clean
	$(NOECHO)ARCH=$(ARCH) SUBARCH=$(SUBARCH) TARGET=$(TARGET) VERBOSE=$(VERBOSE) DEBUG=$(DEBUG) SYSROOT_DIR=$(SYSROOT_DIR) LIB_DIR=$(LIB_DIR) INC_DIR=$(INC_DIR) make -C libgui clean
	$(NOECHO)ARCH=$(ARCH) SUBARCH=$(SUBARCH) TARGET=$(TARGET) VERBOSE=$(VERBOSE) DEBUG=$(DEBUG) SYSROOT_DIR=$(SYSROOT_DIR) PROG_DIR=$(PROG_DIR) make -C guitest clean

clean-all:
ifeq ($(UNSUPPORTED_ARCH),true)
	$(error Unsupported architecture $(ARCH), subarch $(SUBARCH))
endif
	$(NOECHO)ARCH=$(ARCH) SUBARCH=$(SUBARCH) TARGET=$(TARGET) VERBOSE=$(VERBOSE) DEBUG=$(DEBUG) SYSROOT_DIR=$(SYSROOT_DIR) LIB_DIR=$(LIB_DIR) INC_DIR=$(INC_DIR) make -C libchicago clean-all
	$(NOECHO)ARCH=$(ARCH) SUBARCH=$(SUBARCH) TARGET=$(TARGET) VERBOSE=$(VERBOSE) DEBUG=$(DEBUG) SYSROOT_DIR=$(SYSROOT_DIR) PROG_DIR=$(PROG_DIR) make -C osmngr clean-all
	$(NOECHO)ARCH=$(ARCH) SUBARCH=$(SUBARCH) TARGET=$(TARGET) VERBOSE=$(VERBOSE) DEBUG=$(DEBUG) SYSROOT_DIR=$(SYSROOT_DIR) PROG_DIR=$(PROG_DIR) THEME_DIR=$(THEME_DIR) FONT_DIR=$(FONT_DIR) make -C guimngr clean-all
	$(NOECHO)ARCH=$(ARCH) SUBARCH=$(SUBARCH) TARGET=$(TARGET) VERBOSE=$(VERBOSE) DEBUG=$(DEBUG) SYSROOT_DIR=$(SYSROOT_DIR) LIB_DIR=$(LIB_DIR) INC_DIR=$(INC_DIR) make -C libgui clean-all
	$(NOECHO)ARCH=$(ARCH) SUBARCH=$(SUBARCH) TARGET=$(TARGET) VERBOSE=$(VERBOSE) DEBUG=$(DEBUG) SYSROOT_DIR=$(SYSROOT_DIR) PROG_DIR=$(PROG_DIR) make -C guitest clean-all

remake: clean all
